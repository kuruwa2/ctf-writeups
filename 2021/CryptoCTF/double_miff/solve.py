from Crypto.Util.number import *
from sage.all import *

x1, y1 = (540660810777215925744546848899656347269220877882, 102385886258464739091823423239617164469644309399)
x2, y2 = (814107817937473043563607662608397956822280643025, 961531436304505096581595159128436662629537620355)
x3, y3 = (5565164868721370436896101492497307801898270333, 496921328106062528508026412328171886461223562143)

p = gcd(x1*y2*(y1**2-1)*(x2**2-1)-x2*y1*(x1**2-1)*(y2**2-1), x1*y3*(y1**2-1)*(x3**2-1) - x3*y1*(x1**2-1)*(y3**2-1)) // 24

F = PolynomialRing(GF(p), 'x')
for i in range(2):
    X, Y = (x3, x2)[i], (y3, y2)[i]
    x = F.gens()[0]
    f = (2*X*(1+x**2)*Y**2*(x**2-1)**2-2*(2*x+X+x**2*X)*(1+x**2)**2)**2 - (2*x+X+x**2*X)**2*(1+x**2)**2*((2+2*x**2)**2 - 4*(x**2*Y-Y)**2)
    for j in f.roots():
        print(long_to_bytes(j[0]))

#CCTF{D39enEr47E_ECC_4TtaCk!_iN_Huffs?}
